<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Статистика и аналитика</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
<div class="page">
    <div class="nav">
        <a href="/admin/panel" class="button">Назад в админ-панель</a>
        <a href="/" class="button">На главную</a>
        <div id="session-info"></div>
    </div>

    <div class="card">
        <h1>Статистика и аналитика</h1>
        
        <div th:if="${error != null}" style="margin-bottom: 20px; padding: 12px; background: #fee2e2; border: 1px solid #dc2626; border-radius: 8px; color: #dc2626;">
            <strong>Ошибка:</strong> <span th:text="${error}"></span>
        </div>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-top: 24px;">
            <!-- Общая стоимость заказов -->
            <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 24px; border-radius: 12px;">
                <h3 style="margin-top: 0; color: white; font-size: 16px; font-weight: 600; margin-bottom: 12px;">Общая стоимость всех заказов</h3>
                <div style="font-size: 32px; font-weight: 700;">
                    <span th:text="${totalOrdersCost}"></span> ₽
                </div>
            </div>
            
            <!-- Общее количество заказов -->
            <div style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; padding: 24px; border-radius: 12px;">
                <h3 style="margin-top: 0; color: white; font-size: 16px; font-weight: 600; margin-bottom: 12px;">Всего заказов</h3>
                <div style="font-size: 32px; font-weight: 700;">
                    <span th:text="${totalOrdersCount}"></span>
                </div>
            </div>
            
            <!-- Оплаченные заказы -->
            <div style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white; padding: 24px; border-radius: 12px;">
                <h3 style="margin-top: 0; color: white; font-size: 16px; font-weight: 600; margin-bottom: 12px;">Оплаченные заказы</h3>
                <div style="font-size: 32px; font-weight: 700;">
                    <span th:text="${paidOrdersCount}"></span>
                </div>
                <div style="font-size: 14px; margin-top: 8px; opacity: 0.9;">
                    Сумма: <span th:text="${paidOrdersCost}"></span> ₽
                </div>
            </div>
            
            <!-- Неоплаченные заказы -->
            <div style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); color: white; padding: 24px; border-radius: 12px;">
                <h3 style="margin-top: 0; color: white; font-size: 16px; font-weight: 600; margin-bottom: 12px;">Неоплаченные заказы</h3>
                <div style="font-size: 32px; font-weight: 700;">
                    <span th:text="${unpaidOrdersCount}"></span>
                </div>
            </div>
        </div>
        
        <!-- Самая популярная услуга -->
        <div style="margin-top: 32px; padding: 24px; background: #f9fafb; border-radius: 12px; border-left: 4px solid #059669;">
            <h2 style="margin-top: 0; color: #059669;">Самая популярная услуга</h2>
            <div th:if="${mostPopularService != null}">
                <div style="display: flex; align-items: center; gap: 16px; margin-top: 16px;">
                    <div style="background: #059669; color: white; width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 24px; font-weight: 700; flex-shrink: 0;">
                        <span th:text="${mostPopularServiceCount}"></span>
                    </div>
                    <div>
                        <h3 style="margin: 0; font-size: 20px; color: #1f2937;">
                            <span th:text="${mostPopularService.serviceName}"></span>
                        </h3>
                        <p style="margin: 8px 0 0 0; color: #6b7280; font-size: 14px;">
                            Время работы: <span th:text="${mostPopularService.serviceTime}"></span>
                        </p>
                        <p style="margin: 8px 0 0 0; color: #059669; font-weight: 600;">
                            Заказана <span th:text="${mostPopularServiceCount}"></span> 
                            <span th:text="${mostPopularServiceCount == 1 ? 'раз' : (mostPopularServiceCount < 5 ? 'раза' : 'раз')}"></span>
                        </p>
                    </div>
                </div>
            </div>
            <div th:if="${mostPopularService == null}" style="color: #6b7280; font-style: italic;">
                Пока нет заказанных услуг
            </div>
        </div>
    </div>
</div>
<script src="/js/app.js"></script>
</body>
</html>

